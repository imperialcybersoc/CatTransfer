{% extends "base.html" %}

{% block title %}View File - CatTransfer {% endblock %}

{% block content %}
<form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data">
    <div class="upload-box" onclick="document.getElementById('fileInput').click()">
        <h2>Select or drop files</h2>
    </div>
    <input type="file" id="fileInput" name="file" onchange="this.form.submit()">
</form>

<div class="view-form">
    <h3>File Viewer</h3>
    <p style="margin-bottom: 15px; color: #666;">Viewing file path: <code>{{ file_path if file_path else 'No file selected' }}</code></p>
        
    {% if is_image %}
    <div class="image-container">
        <img src="{{ url_for('serve_file', file_path=file_path) }}" alt="Image" style="max-width: 100%; border-radius: 8px; border: 2px solid #ddd;">
    </div>
    {% elif is_binary %}
    <div class="file-content binary">
        <p style="color: #666; margin-bottom: 10px;"><strong>Binary file detected - showing hex dump:</strong></p>
        {{ file_content }}
    </div>
    {% elif file_content %}
    <div class="file-content">{{ file_content }}</div>
    {% endif %}
    
    {% if error %}
    <div class="error">{{ error }}</div>
    {% endif %}
    
    {% if not file_path %}
    <p style="margin-top: 15px; color: #666;">Select a file from the list below to view its contents.</p>
    {% endif %}
</div>

{% if uploaded_files %}
<div class="file-list">
    <h3>Available Files</h3>
    {% for filename in uploaded_files %}
    <div class="file-item">
        <span>{{ filename }}</span>
        <a href="{{ url_for('view_file', file='uploads/' + filename) }}" class="file-link">
            View: uploads/{{ filename }}
        </a>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}

